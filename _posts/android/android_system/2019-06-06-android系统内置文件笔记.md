---
layout: post
title: Android系统内置文件笔记
categories: Android
description: Android 6.0 系统内置文件
keywords: Android , 6.0， 系统预置，系统内置，预置文件，内置文件
---

### 1、前言

本次修改时基于MTK 6.0 版的系统下修改，其他版本的系统修改方式也类似，往系统里面内置文件有多种方式，接下来将记录比较简便的方法，主要是通过shell脚步调用 cp 命令来拷贝文件到指定目录，不过需要注意的是cp的方式在编译的过程不会报错，所以路径或文件写错了编译的过程是没有提示的，结果只有编译了才知道。

### 2、创建自己的文件夹

进入Android源码的根目录apls , 在sdk目录下创建一个自己的目录比如：UsbPrintDriver 

```shell
 :~/phone/mtk/kt109/alps$ cd sdk/
 :~/phone/mtk/kt109/alps/sdk$ mkdir UsbPrintDriver

```

### 3、拷贝文件

将需要内置到系统的文件拷贝到sdk/UsbPrintDriver目录下


```shell
 :~/phone/mtk/kt109/alps$  cp -a ~/UsbPrintDriver/. sdk/UsbPrintDriver/
 :~/phone/mtk/kt109/alps$ tree sdk/UsbPrintDriver/
sdk/UsbPrintDriver/
├── busybox
└── MT
    ├── data
    │   └── misc
    │       └── printer
    │           └── tmp
    └── system
        ├── bin
        │   ├── foo2zjs
        │   └── gs
        └── usr
            └── share
                └── printer
                    └── test
                        ├── HelloWorld.hpljp1106
                        ├── HelloWorld.pdf
                        └── MT8783.txt

11 directories, 6 files
 :~/phone/mtk/kt109/alps$


```



### 4、创建Android.mk 文件

*说明：博主想要实现的是:*
	*1.将busybox 拷贝到 /system/bin/目录下*
	*2.将MT/data/ 目录的全部内容拷贝到 /data/ 目录下   cp -a 会保留文件原有的属性* 
	*3.将MT/system/目录下的全部文件拷贝到 /system/ 目录下*

创建Android.mk 并保存

```shell
 :~/phone/mtk/kt109/alps$ vim sdk/UsbPrintDriver/Android.mk
  1 LOCAL_PATH:= $(call my-dir)
  2    include $(CLEAR_VARS)
  3    $(shell cp -rf $(LOCAL_PATH)/busybox  ${PRODUCT_OUT}/system/bin/)
  4    $(shell cp -a $(LOCAL_PATH)/MT/system/.  ${PRODUCT_OUT}/system/)
  5    $(shell cp -a $(LOCAL_PATH)/MT/data/.  ${PRODUCT_OUT}/data/)
  6


```

Android.mk 文件内容如下：

```makefile
    LOCAL_PATH:= $(call my-dir)
     include $(CLEAR_VARS)
     $(shell cp -rf $(LOCAL_PATH)/busybox  ${PRODUCT_OUT}/system/bin/)
     $(shell cp -a $(LOCAL_PATH)/MT/system/.  ${PRODUCT_OUT}/system/)
     $(shell cp -a $(LOCAL_PATH)/MT/data/.  ${PRODUCT_OUT}/data/)
```

*提示：若改为 PRODUCT_COPY_FILES 方式 ，怎可能会报错*
*build/core/main.mk:532: *** The following variables have been changed: PRODUCT_COPY_FILES.  Stop.*

```makefile
LOCAL_PATH:= $(call my-dir)
PRODUCT_COPY_FILES += $(LOCAL_PATH)/busybox:system/bin/busybox

```

### 5、修改完成

修改完后的文件结构为：

```shell
 :~/phone/mtk/kt109/alps$ tree sdk/UsbPrintDriver/
sdk/UsbPrintDriver/
├── Android.mk
├── busybox
└── MT
    ├── data
    │   └── misc
    │       └── printer
    │           └── tmp
    └── system
        ├── bin
        │   ├── foo2zjs
        │   └── gs
        └── usr
            └── share
                └── printer
                    └── test
                        ├── HelloWorld.hpljp1106
                        ├── HelloWorld.pdf
                        └── MT8783.txt

11 directories, 7 files
 :~/phone/mtk/kt109/alps$
```



完成修改，接下来重新编译即可